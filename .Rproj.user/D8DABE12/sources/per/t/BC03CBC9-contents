#' Specify the mean model for the data generating process.
#'
#' A wrapper for \code{\link[stats]{lm}} and \code{\link[stats]{glm}} which
#' allows the user to specify the form of the model for the mean response of
#' the data generating process through the symbol "constant"
#'
#' \code{specify_mean_model} provides a single interface to both \code{lm} and
#' \code{glm} with the largest difference being the ability to specify an
#' offset term which is a scalar.
#'
#' @param formula an object of class "\code{\link[stats]{formula}}": a symbolic
#' description of the form of the mean response model.
#' @param data an optional data frame containing the variables appearing in
#' \code{formula}.
#' @param family a description of the error distribution and link function to
#' be used in the model. See \code{\link[stats]{glm}} for details. If missing
#' (default), a linear model is used.
#' @param ... additional arguments to pass to \code{\link[stats]{lm}} or
#' \code{\link[stats]{glm}}.
#'
#' @return
#'
#' @examples
#'
#' @aliases specify_process
#'
#' @import stats
#' @export
specify_mean_model <- function(formula,
                               data,
                               family,
                               ...){

  # allow use of 'constant' to specify
  formula <- as.character(formula)
  formula[3] <- gsub(pattern = "constant\\(",
                     replacement =
                       paste0("offset\\(rep\\(0, length\\(",
                              formula[2], "\\)\\) \\+ "),
                     formula[3])

  formula <- as.formula(paste(formula[c(2, 1, 3)], collapse = " "))

  formula
}